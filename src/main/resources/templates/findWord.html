<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="http://www.thymeleaf.org">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
		<title>忘记密码</title>
		<meta name="keywords" content="">
		<meta name="description" content="">
		<script th:src="@{/js/rem.js}"></script>
		<script th:src="@{/js/jquery.min.js}" type="text/javascript"></script>
		<link rel="stylesheet" type="text/css" th:href="@{/css/bootstrap.min.css}" />
		<link rel="stylesheet" type="text/css" th:href="@{/css/base.css}" />
		<link rel="stylesheet" type="text/css" th:href="@{/css/page.css}" />
		<link rel="stylesheet" type="text/css" th:href="@{/css/all.css}" />
		<link rel="stylesheet" type="text/css" th:href="@{/css/mui.min.css}" />
		<link rel="stylesheet" type="text/css" th:href="@{/css/loaders.min.css}" />
		<link rel="stylesheet" type="text/css" th:href="@{/css/style.mobile.css}" />
		<!-- <link rel="stylesheet" type="text/css" href="css/loading.css"/> -->
		<link rel="stylesheet" type="text/css" th:href="@{/slick/slick.css}" />
		<link rel="stylesheet" type="text/css" th:href="@{/iconfont/iconfont.css}" />
	</head>

	<body>
		<!--header star-->
		<header class="mui-bar mui-bar1 mui-bar-nav mui-bar-nav1" id="header">
			<a class="back-btn" th:href="@{/javascript:value(0)}" th:onclick="history.back()">
				X
				<!--<i class="iconfont icon-fanhui">X</i>-->
			</a>
			<div class="mui-title">修改密码</div>
		</header>
		<!--header end-->
		
		<div class="warp clearfloat" style="padding: 0.4rem;background: #fff;">
					<input type="hidden" value="18235389217" id="ph"><!--//到这个界面需要把手机号传过来-->
					<div class="form-group login-group_re">
						<i class="iconfont icon-mima"></i>
						<input type="password"   name="usermail"  class="form-control inpt-form"  id="btn"  placeholder="请输入旧密码">
						<span id="itemspan"></span>

					</div>
					</br>
					<!--<div class="form-group login-group_re">
						<i class="iconfont icon-yanzhengma2"></i>
						<input type="tel" class="form-control inpt-form yzm" id="tel" placeholder="请输入手机号验证码">
						<input type="button" id="btn" th:value="获取验证码" onclick="settime(this)" style="margin-top:-50px; margin-left: 290px"/>
						<span id="pwdspan" ></span>
						&lt;!&ndash;<a href="javascript:;" id="getCode" onclick="settime(this)" data-appid="2034800824" data-cbfn="callback" class="linkABlue yanzheng">获取验证码</a>&ndash;&gt;
					</div>-->
					<div class="form-group login-group_re">
						<i class="iconfont icon-mima"></i>
						<!-- <input type="email" class="form-control inpt-form" placeholder="请输入密码"> -->
						<input   name="pwd1"   class="form-control inpt-form" type="password"
						 placeholder="请输入新密码(密码设置6-20为字符)"><span id="pwd1span"></span>
					</div></br>
					<div class="form-group login-group_re">
						<i class="iconfont icon-mima"></i>
						<!-- <input type="email" class="form-control inpt-form" placeholder="请输入密码"> -->
						<input   name="pwd2"   class="form-control inpt-form" type="password"
						 placeholder="请重复输入新密码"><span id="pwd2span"></span>
					</div></br>
					<!--<input type="submit" class="conf-btn login-btns" value="提交">
					<input type="reset"  value="重置">-->
					<button type="button" class="conf-btn login-btns" th:onclick="saveInfo()">确认修改</button>

		
		</div>
		
		<script type="text/javascript" th:src="@{/js/jquery.min.js}"></script>
		<script type="text/javascript" th:src="@{/js/bootstrap.min.js}"></script>
		<!-- 密码显示隐藏 -->
		<script th:src="@{/js/bootstrap-show-password.js}"></script>
		
		<script th:src="@{/js/mui.min.js}"></script>
		<script type="text/javascript" th:src="@{/js/hmt.js}"></script>
		<script th:src="@{/slick/slick.js}" type="text/javascript"></script>
		<script th:src="@{/js/swiper.min.js}"></script>
	</body>
<script>
    //失去焦点去掉红字
    $("[name='usermail']").blur(function(){
        $("#itemspan").html("");
        $("#usermail").css("border-color","gainsboro");

    })
    //手机号验证有没有注册
    var flag=true;
    $("[name='usermail']").blur(function(){
        flag=true;
        var email=$("[name='usermail']").val();
        //alert(email);
        /*if(email==""){
            $("#itemspan").html("请填写手机号").css("color", "red");
            return false;
        }*/
        if(email!=""){
            $.post("/yanPhone","userpas="+email,function(obj){
                alert(obj);
                if(obj=="true"){
                    //$("#itemspan").html("手机号没有注册").css("color", "red");
                    flag=false;
                }
            })
		}
    })
   /* //时间倒计时
    var countdown = 60;
    function settime(val) {
        if (countdown == 0) {
            val.removeAttribute("disabled");
            val.value = "获取验证码";
            countdown = 60;
            return ;
        } else {
            val.setAttribute("disabled", true);
            val.value = "重新发送(" + countdown + ")";
            countdown--;

        }
        setTimeout(function() {
            settime(val)
        }, 1000)
    }
    //获取后台验证码
    var nn=null;
    $("#btn").click(function() {
        var email1=$("[name='usermail']").val();

        $.get("/num.do", "userPhone="+email1,function(obj) {
            //alert(obj);/!*obj是后台正确的验证*!/
            nn=obj;
           // alert(nn+"获取后台的验证码");
        })
    })*/

    /*//失去焦点提示验证码是否正确

    var flag=true;
    $(".yzm").blur(function(){
        var t=$("#btn").val();
        //alert(t);
        if(t=="获取验证码"){//如果过了60秒，重置赋值为空
            nn=null;
        }
        flag=true;
        var num=$(".yzm").val();//jsp界面用户输入的验证码，obj是后台正确的验证码
		/!*alert(num+"前段验证码的值");
        alert(nn+"这是nn获取后端的");*!/
        $("#pwdspan").html("");
        $(".yzm").css("border-color","gainsboro");
        if(num!=""&&nn!=num){
            $("#pwdspan").html("验证码不正确").css("color", "red");
            $(".yzm").css("border-color","red");
            flag=false;
            //alert("验证码不正确");
        }
    })*/
    //j旧密码框失去焦点去掉红字
    $("[name='usermail']").blur(function(){
        $("#itemspan").html("");
        $("[name='usermail']").css("border-color","gainsboro");
    })

    //密码框失去焦点去掉红字
    $("[name='pwd1']").blur(function(){
        $("#pwd1span").html("");
        $("[name='pwd1']").css("border-color","gainsboro");
    })
    //重复密码框失去焦点去掉红字
    $("[name='pwd2']").blur(function(){
        $("#pwd2span").html("");
        $("[name='pwd2']").css("border-color","gainsboro");
    })


	function saveInfo() {
        var usermail=$("[name='usermail']").val();
        if(usermail==""){
            $("#itemspan").html("密码不能为空").css("color", "red");
            $("[name='usermail']").css("border-color","red");
            return false;
        }



        var pwd1=$("[name='pwd1']").val();
        if(pwd1==""){
            $("#pwd1span").html("密码不能为空").css("color", "red");
            $("[name='pwd1']").css("border-color","red");
            return false;
        }else if(pwd1.length<6||pwd1.length>20){
            $("#pwd1span").html("密码长度为6-16").css("color", "red");
            $("[name='pwd1']").css("border-color","red");
            return false;
        }
        //重复密码非空验证
        var pwd2=$("[name='pwd2']").val();
        //alert(pwd2+"这是重复Miami");
        if(pwd2==""){
            $("#pwd2span").html("密码不能为空").css("color", "red");
            $("[name='pwd2']").css("border-color","red");
            return false;
        }else if(pwd1!=pwd2){
            $("#pwd2span").html("两次密码不一致").css("color", "red");
            $("[name='pwd2']").css("border-color","red");
            return false;
        }else if(pwd2.length<6||pwd2.length>16){
            $("#pwd2span").html("密码长度为6-16").css("color", "red");
            $("[name='pwd2']").css("border-color","red");
            return false;
        }
        if(flag==false){
            $("#itemspan").html("旧密码不正确").css("color", "red");
            return false;

        }

        /* //正则表达式手机号
         var zhengzephone=/^1[3|4|5|7|8][0-9]{9}$/;

         var item=$("[name='usermail']").val();
         if(zhengzephone.test(item)==false){
             $("#itemspan").html("手机号格式不正确(请输入11手机号)").css("color", "red");*/

		var userphone=$("#ph").val();
        alert(userphone);
        location.href="/updatepass?userphone="+userphone+"&pwd1="+pwd1;
    }



</script>
</html>
